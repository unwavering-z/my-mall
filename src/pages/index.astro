---
// 1. å¯¼å…¥ä½ çš„â€œè´¦æœ¬â€æ•°æ®
import productData from '../data/products.json';
import '../styles/mall.css';
const { festival } = productData;
// 2. å®šä¹‰å½“å‰å“ç‰Œï¼ˆé¦–é¡µé»˜è®¤æ˜¯æ„Ÿæ©å†Œï¼‰
const currentBrandId = "ganen";
const currentBrand = productData.brands.find(b => b.id === currentBrandId);

// 3. è‡ªåŠ¨ç­›é€‰å‡ºå±äºâ€œæ„Ÿæ©å†Œâ€çš„äº§å“
const displayProducts = productData.items.filter(item => item.brandId === currentBrandId);
---

<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{currentBrand.name} - 2026æ˜¥èŠ‚å›¢è´­</title>
</head>
<body>
    ---
// å·²ç»åœ¨é¡¶éƒ¨ import äº† productData
const { festival } = productData;
---

<div class="festival-banner" id="countdown-banner">
  <span class="festival-name">ğŸ® {festival.name}</span>
  <span class="countdown-text">
    è·èŠ‚æ—¥è¿˜æœ‰ <strong id="days-count">--</strong> å¤©
  </span>
</div>

<script define:vars={{ targetDate: festival.targetDate }}>
  function updateCountdown() {
    const target = new Date(targetDate).getTime();
    const now = new Date().getTime();
    const gap = target - now;
    
    const d = Math.floor(gap / (1000 * 60 * 60 * 24));
    document.getElementById('days-count').innerText = d > 0 ? d : 0;
  }
  updateCountdown();
</script>

<style>
  .festival-banner {
    background: #e4393c; /* é»˜è®¤çº¢è‰²ï¼Œä¹Ÿå¯ä»¥ç”¨ {festival.themeColor} */
    color: white;
    padding: 8px 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 13px;
    position: sticky;
    top: 0;
    z-index: 1001;
  }
  .festival-name { font-weight: bold; }
  #days-count { font-size: 16px; color: #ffeb3b; margin: 0 2px; }
</style>
    <header class="hero-banner">
        <img src="/hero-banner.png" alt="é©¬å¹´å¤§å‰" />
    </header>

    <main class="mall-container">
        <nav class="side-menu">
            {productData.brands.map((brand) => (
                <a href={`/${brand.slug === 'index' ? '' : brand.slug}`} 
                   class={brand.id === currentBrandId ? "active" : ""}>
                    {brand.name}
                </a>
            ))}
        </nav>

        <section class="product-grid">
            <div class="grid">
                {displayProducts.map((product) => (
                    <a href={`/details/${product.detail}`} class="product-link">
                        <div class="product-card">
                            <img src={product.image} alt={product.name} />
                            <div class="info">
                                <h3>{product.name}</h3>
                                <p class="price">{product.price}</p>
                            </div>
                        </div>
                    </a>
                ))}
            </div>
        </section>
    </main>
</body>
</html>